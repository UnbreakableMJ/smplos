# smplOS Window Rules
# See https://wiki.hyprland.org/Configuring/Window-Rules/ for more

# ============================================================================
# Layer rules (EWW bar + popups)
# ============================================================================

# Frosted glass blur behind the bar
layerrule = blur on, match:namespace eww-bar
layerrule = blur_popups on, match:namespace eww-bar
layerrule = ignore_alpha 0.1, match:namespace eww-bar
layerrule = xray off, match:namespace eww-bar

# Blur behind calendar popup
layerrule = blur on, match:namespace eww-calendar-popup
layerrule = blur_popups on, match:namespace eww-calendar-popup
layerrule = ignore_alpha 0.1, match:namespace eww-calendar-popup
layerrule = xray off, match:namespace eww-calendar-popup

# Blur behind quick settings panel
layerrule = blur on, match:namespace eww-quick-settings
layerrule = blur_popups on, match:namespace eww-quick-settings
layerrule = ignore_alpha 0.1, match:namespace eww-quick-settings
layerrule = xray off, match:namespace eww-quick-settings

# Blur behind notification hub
layerrule = blur on, match:namespace eww-notification-hub
layerrule = blur_popups on, match:namespace eww-notification-hub
layerrule = ignore_alpha 0.1, match:namespace eww-notification-hub
layerrule = xray off, match:namespace eww-notification-hub

# Blur behind USB popup
layerrule = blur on, match:namespace eww-usb-popup
layerrule = blur_popups on, match:namespace eww-usb-popup
layerrule = ignore_alpha 0.1, match:namespace eww-usb-popup
layerrule = xray off, match:namespace eww-usb-popup

# ============================================================================
# Rofi launcher (layer surface on Wayland -- needs layerrule, not windowrule)
# ============================================================================
layerrule = animation slide left, match:namespace rofi
layerrule = order -1, match:namespace rofi
layerrule = blur on, match:namespace rofi
layerrule = blur_popups on, match:namespace rofi
layerrule = ignore_alpha 0.1, match:namespace rofi

# Rofi dialogs (keybind-help, theme-picker use -normal-window for popin animation)
windowrule = float on, match:class ^(rofi)$
windowrule = center on, match:class ^(rofi)$
windowrule = pin on, match:class ^(rofi)$
windowrule = animation popin, match:class ^(rofi)$
windowrule = opacity $themePopupOpacity override $themePopupOpacity override, match:class ^(rofi)$

# ============================================================================
# Window rules
# ============================================================================

# Prevent maximize from apps
windowrule = suppress_event maximize, match:class .*

# Frosted glass opacity (controlled by theme)
# Default app opacity — applied to all windows first
windowrule = opacity $themeOpacityActive $themeOpacityInactive, match:class .*

# Terminal override — match class directly (st-wl app_id="terminal", see config.h)
windowrule = opacity $themeTermOpacityActive $themeTermOpacityInactive, match:class ^(terminal|com\.mitchellh\.ghostty)$

# Keep media and fullscreen content fully opaque
windowrule = opacity 1.0 1.0, match:class ^(mpv|imv|vlc|firefox|chromium|brave-browser|brave)$
windowrule = opacity 1.0 1.0, match:fullscreen 1

# Fix some dragging issues with XWayland
windowrule = no_focus on, match:class ^$, match:title ^$, match:xwayland 1, match:float 1, match:fullscreen 0, match:pin 0

# ============================================================================
# Application-specific rules
# ============================================================================

# File picker dialogs
windowrule = float on, match:title ^(Open File)(.*)$
windowrule = float on, match:title ^(Save File)(.*)$
windowrule = float on, match:title ^(Select)(.*)$
windowrule = center on, match:title ^(Open File)(.*)$
windowrule = center on, match:title ^(Save File)(.*)$

# Calculator
windowrule = float on, match:class ^(gnome-calculator)$
windowrule = size 400 500, match:class ^(gnome-calculator)$

# Image viewer
windowrule = float on, match:class ^(imv)$
windowrule = center on, match:class ^(imv)$

# Pavucontrol
windowrule = float on, match:class ^(pavucontrol)$
windowrule = size 800 600, match:class ^(pavucontrol)$

# Network Manager
windowrule = float on, match:class ^(nm-connection-editor)$

# Polkit
windowrule = float on, match:class ^(polkit-gnome-authentication-agent-1)$
windowrule = center on, match:class ^(polkit-gnome-authentication-agent-1)$

# Floating terminal windows (theme picker, etc.)
windowrule = float on, match:class ^(floating)$
windowrule = center on, match:class ^(floating)$
windowrule = size 500 600, match:class ^(floating)$


# Notification Center (notif-center)
windowrule = float on, match:class ^(notif-center)$
windowrule = decorate 0, match:class ^(notif-center)$
windowrule = move (monitor_w-window_w-2) (monitor_h-window_h-34), match:class ^(notif-center)$
windowrule = no_shadow on, match:class ^(notif-center)$
windowrule = opacity $themePopupOpacity override $themePopupOpacity override, match:class ^(notif-center)$
windowrule = animation slide, match:class ^(notif-center)$
