# smplOS Hyprland Autostart Configuration

# Core services
exec-once = hypridle
exec-once = dunst

# Sync saved keyboard layouts to compositor (before EWW bar starts)
exec-once = kb-sync

# Restore last wallpaper (must run before bar to generate colors)
exec-once = bash -c 'theme-bg-init'

# Status bar (EWW) - launch after a short delay to ensure theme is ready
exec-once = bash -c 'sleep 0.5 && bar-ctl start'

# Auto-mount USB, CD, HDD (notify on mount/unmount)
exec-once = automount

# Credential storage (VS Code, Brave, git, etc.)
exec-once = gnome-keyring-daemon --start --components=secrets,pkcs11,ssh

# Polkit agent for authentication dialogs
exec-once = /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1

# Clean stale browser locks (VM force-shutdown leaves these behind)
exec-once = pgrep -x brave >/dev/null || rm -f ~/.config/BraveSoftware/Brave-Browser/Singleton*

# Propagate full environment to systemd/dbus (portals, gnome-keyring, etc.)
# xdg-desktop-portal-gtk needs the session env to read gsettings/dconf
exec-once = systemctl --user import-environment
exec-once = dbus-update-activation-environment --systemd --all

# Welcome notification with essential keybindings (first boot only)
exec-once = smplos-first-run
