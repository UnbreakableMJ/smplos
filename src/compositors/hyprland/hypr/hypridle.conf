# smplOS Hypridle Configuration
# Manages idle timeouts: screen lock, DPMS, suspend
#
# NOTE: DPMS off and suspend are disabled inside VMs (QEMU/KVM/VirtualBox)
# because virtual displays can't handle DPMS wake and VM suspend is
# unrecoverable without ACPI passthrough.

general {
    lock_cmd = lock-screen
    before_sleep_cmd = loginctl lock-session
    after_sleep_cmd = hyprctl dispatch dpms on
}

listener {
    timeout = 300                      # 5min -- lock screen
    on-timeout = loginctl lock-session
}

listener {
    timeout = 330                                            # 5.5min -- screen off
    on-timeout = systemd-detect-virt -q && exit 0 || hyprctl dispatch dpms off
    on-resume = hyprctl dispatch dpms on && brightnessctl -r
}

listener {
    timeout = 600                      # 10min -- suspend (skip in VMs)
    on-timeout = systemd-detect-virt -q && exit 0 || systemctl suspend
}
