#!/bin/bash
# smplOS: First-run welcome notifications
# Triggered by exec-once in autostart.conf -- sentinel file makes it one-shot.
#
# Shows two persistent notifications:
#   1. Keybindings -- text-only, dismiss with click
#   2. Update -- clickable, opens terminal with pacman -Syu
#
# dunst left-click = do_action + close. For the update notification,
# clicking triggers the action (opens terminal). For keybindings,
# clicking just dismisses (no action defined).

SENTINEL="$HOME/.local/state/smplos/first-run.done"
[[ -f "$SENTINEL" ]] && exit 0

mkdir -p "$(dirname "$SENTINEL")"
touch "$SENTINEL"

# Wait for dunst to be ready
sleep 3

# 1. Keybindings (persistent, no action -- click to dismiss)
dunstify -t 0 -i input-keyboard \
  "Learn Keybindings" \
  "Super  Start menu\nSuper+K  All keybindings\nSuper+Shift+T  Change theme\nSuper+Enter  Terminal"

# 2. Update (persistent -- notif-center handles double-click action)
dunstify -t 0 -i system-software-update \
  "System Update" \
  "When you have internet, click here to update"
